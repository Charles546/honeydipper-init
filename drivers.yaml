---
drivers:
  daemon:
    configCheckInterval: 60m
    featureMap:
      global:
        cache: redis-cache
    features:
      global:
        - name: cache
      operator:
        - name: "driver:ollama"

    drivers:
      redis-cache:
        name: redis-cache
        type: builtin
        handlerData:
          shortName: redis-cache
      ollama:
        name: ollama
        type: builtin
        handlerData:
          shortName: hd-driver-ollama

  redisqueue: &redis
    connection:
      Addr: "{% .env.REDIS_ADDR %}"
      Password: "{% .env.REDIS_AUTH %}"
  redispubsub: *redis
  redislock: *redis
  api-broadcast: *redis
  redis-cache:
    <<: *redis
    connection:
      DB: "1"

  kubernetes:
    api_timeout: "30"

  vault:
    addr: https://vault.m4cloud.duckdns.org:8200
    k8sRole: '{% empty .env.VAULT_TOKEN | ternary "honeydipper" "" %}'
    token: '{% with .env.VAULT_TOKEN %}{% . %}{% end %}'

  web:
    token_sources:
      hd_github_app:
        type: github
        app_id: "1109324"
        installation_id: "59458128"
        key: LOOKUP[vault,/secret/data/honeydipper/github#ssh_key]
        permissions:
          contents: read
          statuses: write
