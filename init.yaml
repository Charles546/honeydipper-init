---
repos:
  - repo: https://github.com/honeydipper/honeydipper-config-essentials.git
    branch: main
  - repo: https://github.com/honeydipper/honeydipper-config-essentials.git
    branch: CH-vault
    path: vault

drivers:
  daemon:
    configCheckInterval: 60m

  redisqueue: &redis
    connection:
      Addr: "{% .env.REDIS_ADDR %}"
      Password: "{% .env.REDIS_AUTH %}"
  redispubsub: *redis
  redislock: *redis
  api-broadcast: *redis

  kubernetes:
    api_timeout: "30"

  vault:
    addr: https://vault.m4cloud.duckdns.org:8200
    k8sRole: honeydipper

  web:
    token_sources:
      hd_github_app:
        type: github
        app_id: "1109324"
        installation_id: "59458128"
        key: LOOKUP[valut,/secret/data/honeydipper/github#ssh_key]
        permissions:
          contents: read
          statuses: write

systems:
  slack_bot:
    data:
      token: LOOKUP[vault,/secret/data/honeydipper/slack#bot_token]
      interact_token: $?nil # use signature
      slash_token: $?nil # use signature
      signatureHeader: X-Slack-Signature
      signatureSecret: LOOKUP[vault,/secret/data/honeydipper/slack#signing_secret]

  github:
    data:
      tokenSource: hd_github_app
      signatureHeader: X-Hub-Signature-256
      signatureSecret: LOOKUP[vault,/secret/data/honeydipper/github#signing_secret]
      token: $?nil # use signature
